"use strict";function braces(e,r,t){if(""===e)return[];Array.isArray(r)||(t=r,r=[]);var n=t||{};r=r||[],void 0===n.nodupes&&(n.nodupes=!0);var i,s=n.fn;switch("function"==typeof n&&(s=n,n={}),patternRe instanceof RegExp||(patternRe=patternRegex()),(e.match(patternRe)||[])[0]){case"\\,":return escapeCommas(e,r,n);case"\\.":return escapeDots(e,r,n);case"/.":return escapePaths(e,r,n);case" ":return splitWhitespace(e);case"{,}":return exponential(e,n,braces);case"{}":return emptyBraces(e,r,n);case"\\{":case"\\}":return escapeBraces(e,r,n);case"${":if(!/\{[^{]+\{/.test(e))return r.concat(e);i=!0,e=tokens.before(e,es6Regex())}braceRe instanceof RegExp||(braceRe=braceRegex());var a=braceRe.exec(e);if(null==a)return[e];var c=a[1],p=a[2];if(""===p)return[e];var o,u;if(-1!==p.indexOf(".."))u=(o=expand(p,n,s)||p.split(",")).length;else{if('"'===p[0]||"'"===p[0])return r.concat(e.split(/['"]/).join(""));if(o=p.split(","),n.makeRe)return braces(e.replace(c,wrap(o,"|")),n);1===(u=o.length)&&n.bash&&(o[0]=wrap(o[0],"\\"))}for(var f,l=o.length,_=0;l--;){var b=o[_++];if(/(\.[^.\/])/.test(b))return u>1?o:[e];if(f=splice(e,c,b),/\{[^{}]+?\}/.test(f))r=braces(f,r,n);else if(""!==f){if(n.nodupes&&-1!==r.indexOf(f))continue;r.push(i?tokens.after(f):f)}}return n.strict?filter(r,filterEmpty):r}function exponential(e,r,t){"function"==typeof r&&(t=r,r=null);var n,i=r||{},s="__ESC_EXP__",a=0,c=e.split("{,}");if(i.nodupes)return t(c.join(""),i);a=c.length-1;for(var p=(n=t(c.join(s),i)).length,o=[],u=0;p--;){var f=n[u++];if(-1===f.indexOf(s))o.push(f);else if((f=f.split("__ESC_EXP__").join(""))&&!1!==i.nodupes)o.push(f);else{var l=Math.pow(2,a);o.push.apply(o,repeat(f,l))}}return o}function wrap(e,r){return"|"===r?"("+e.join(r)+")":","===r?"{"+e.join(r)+"}":"-"===r?"["+e.join(r)+"]":"\\"===r?"\\{"+e+"\\}":void 0}function emptyBraces(e,r,t){return braces(e.split("{}").join("\\{\\}"),r,t)}function filterEmpty(e){return!!e&&"\\"!==e}function splitWhitespace(e){for(var r=e.split(" "),t=r.length,n=[],i=0;t--;)n.push.apply(n,braces(r[i++]));return n}function escapeBraces(e,r,t){return/\{[^{]+\{/.test(e)?(e=e.split("\\{").join("__LT_BRACE__"),e=e.split("\\}").join("__RT_BRACE__"),map(braces(e,r,t),function(e){return(e=e.split("__LT_BRACE__").join("{")).split("__RT_BRACE__").join("}")})):r.concat(e.split("\\").join(""))}function escapeDots(e,r,t){return/[^\\]\..+\\\./.test(e)?(e=e.split("\\.").join("__ESC_DOT__"),map(braces(e,r,t),function(e){return e.split("__ESC_DOT__").join(".")})):r.concat(e.split("\\").join(""))}function escapePaths(e,r,t){return e=e.split("/.").join("__ESC_PATH__"),map(braces(e,r,t),function(e){return e.split("__ESC_PATH__").join("/.")})}function escapeCommas(e,r,t){return/\w,/.test(e)?(e=e.split("\\,").join("__ESC_COMMA__"),map(braces(e,r,t),function(e){return e.split("__ESC_COMMA__").join(",")})):r.concat(e.split("\\").join(""))}function patternRegex(){return/\${|( (?=[{,}])|(?=[{,}]) )|{}|{,}|\\,(?=.*[{}])|\/\.(?=.*[{}])|\\\.(?={)|\\{|\\}/}function braceRegex(){return/.*(\\?\{([^}]+)\})/}function es6Regex(){return/\$\{([^}]+)\}/}function splice(e,r,t){var n=e.indexOf(r);return e.substr(0,n)+t+e.substr(n+r.length)}function map(e,r){if(null==e)return[];for(var t=e.length,n=new Array(t),i=-1;++i<t;)n[i]=r(e[i],i,e);return n}function filter(e,r){if(null==e)return[];if("function"!=typeof r)throw new TypeError("braces: filter expects a callback function.");for(var t=e.length,n=e.slice(),i=0;t--;)r(e[t],i++)||n.splice(t,1);return n}var expand=require("expand-range"),repeat=require("repeat-element"),tokens=require("preserve");module.exports=function(e,r){if("string"!=typeof e)throw new Error("braces expects a string");return braces(e,r)};var braceRe,patternRe;